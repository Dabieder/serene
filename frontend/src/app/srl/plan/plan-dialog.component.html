<div class="shadow pb-4 dialog-page d-flex flex-column">
  <div
    class="dialog-page-header d-flex justify-content-between align-items-center"
  >
    <h4 class="float-left mb-0" i18n>{{ title }}</h4>

    <div class="header-controls float-right">
      <span class="cancel-btn" (click)="closeDialog()"> Cancel </span>
      <button
        class="ml-1 btn btn-rounded db-primary"
        [disabled]="!plan.goal"
        (click)="submit()"
        i18n
      >
        Submit
      </button>
    </div>
  </div>

  <div class="card-body" *ngIf="plan">
    <div>
      <b>Goal</b>
      <div class="mt-2 align-items-center justify-content-center">
        <textarea
          name="learning-goal"
          id="user-message"
          [(ngModel)]="plan.goal"
          (change)="onLearningGoalChange($event)"
          class="form-control learning-goal"
          cols="20"
          rows="3"
        ></textarea>
      </div>
    </div>

    <div class="mt-4">
      <b i18n>Schedule</b>
      <div class="d-flex flex-row align-items-center">
        <mat-checkbox
          class="scheduleCheckbox"
          [(ngModel)]="useStartDate"
          labelPosition="after"
          i18n
        >
          Start Date:
        </mat-checkbox>
        <div class="d-flex flex-row align-items-center">
          <app-plan-date
            [date]="plan.startDate"
            (dateChange)="onStartDateChange($event)"
          ></app-plan-date>
          <!-- <mat-slide-toggle
            class="ml-4"
            (change)="onRemindChange($event)"
            [checked]="plan.remind"
            >Remind</mat-slide-toggle
          > -->
        </div>
      </div>
      <div class="d-flex flex-row align-items-center">
        <mat-checkbox
          class="scheduleCheckbox"
          [(ngModel)]="useEndDate"
          labelPosition="after"
          i18n
        >
          End Date:
        </mat-checkbox>
        <div class="mt-1 d-flex flex-row align-items-center">
          <app-plan-date
            [date]="plan.endDate"
            (dateChange)="onEndDateChange($event)"
          ></app-plan-date>
        </div>
      </div>
      <div *ngIf="!useEndDate && !useStartDate" class="alert alert-info">
        You are more likely to reach goals when you assign a schedule to them.
        <br />
        <a href="#">Learn more about setting goals</a>
      </div>
    </div>

    <div>
      <b i18n>Plans</b>
      <div class="container mb-2">
        <div *ngFor="let subPlan of plan.subPlans" class="row subplan pb-2">
          <button
            class="btn close-btn"
            [style.background-image]="'url(/assets/btn-icons/x_black.svg)'"
            (click)="deleteSubPlan($event, subPlan)"
          ></button>
          <app-srl-subplan-item
            [plan]="subPlan"
            (planChange)="onSubPlanChange($event)"
            class="col-sm-12"
          >
          </app-srl-subplan-item>
        </div>
      </div>

      <div class="container" *ngIf="plan.subPlans.length > 0">
        <div class="row align-items-center justify-content-center">
          <b i18n>Total:</b>
          <span class="ml-2 total-hours">{{
            plan.plannedDuration | timedisplay
          }}</span>
        </div>
      </div>
      <button class="btn db-primary shadow" (click)="addSubPlan($event)">
        <img class="img-icon-small" src="/assets/btn-icons/add_white.svg" />
        <span class="ml-2" i18n>Add Plan</span>
      </button>
    </div>
  </div>

  <div class="align-self-center footer-controls">
    <span class="cancel-btn mr-4" (click)="closeDialog()" i18n> Cancel </span>
    <button
      class="ml-4 btn db-primary shadow"
      (click)="submit()"
      [disabled]="!plan.goal"
      i18n
    >
      Submit
    </button>
  </div>
</div>
